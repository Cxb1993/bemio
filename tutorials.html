

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorials &mdash; bemio v1.0a0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="bemio v1.0a0 documentation" href="index.html"/>
        <link rel="next" title="bemio Module Documentation" href="module_doc.html"/>
        <link rel="prev" title="API" href="api.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> bemio</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#installing-python-and-the-required-dependencies">Installing Python and the Required Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#installing-hdfview">Installing HDFView</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#id4">Downloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#installing">Installing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#loading-data">Loading Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#calculating-impulse-response-functions-and-sate-space-coefficients">Calculating Impulse Response Functions and Sate Space Coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#writing-the-data-to-the-shdf">Writing the Data to the SHDF</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-data-files">Tutorial Data Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wamit">WAMIT</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nemoh">NEMOH</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aqwa">AQWA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="module_doc.html">bemio Module Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="module_doc.html#data-structures">data_structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_doc.html#io-input-output">io (Input/Output)</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">bemio</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Tutorials</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/tutorials.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="tutorials">
<span id="id1"></span><h1>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h1>
<p>This section provides tutorials that show how to use <a class="reference internal" href="api.html#api"><span>API</span></a> to read, process, and save NEMOH, WAMIT, and AQWA simulation data. Specifically, the tutorials show how to:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Create custom programs that read BEM simulation data</li>
<li>Calculate impulse response functions</li>
<li>Calculate state space coefficients from the impulse response functions</li>
<li>Plot the data for visualization</li>
<li>Save the data to the SHDF</li>
</ol>
</div></blockquote>
<p><cite>bemio</cite> was developed so that users interact with the API in the same way regardless of the type of BEM data that is being read and processed. As such, we will present a thorough description of how to process WAMIT data in the &#8216;WAMIT&#8217;_ tutorial, and abbreviated versions of the NEMOH and AQWA tutorials.</p>
<div class="section" id="tutorial-data-files">
<span id="data-files"></span><h2>Tutorial Data Files<a class="headerlink" href="#tutorial-data-files" title="Permalink to this headline">¶</a></h2>
<p>Tutorial files are distributed with the <cite>bemio</cite> code and can be found in the <code class="docutils literal"><span class="pre">$BEMIO_SOURCE/tutorials</span></code> folder. This location will be refereed to as <code class="docutils literal"><span class="pre">$BEMIO_TUTORIALS</span></code>.</p>
</div>
<div class="section" id="wamit">
<span id="wamit-tut"></span><h2>WAMIT<a class="headerlink" href="#wamit" title="Permalink to this headline">¶</a></h2>
<p>WAMIT tutorial files can be found in the <code class="docutils literal"><span class="pre">$BEMIO_TUTORIALS/wamit</span></code> folder. As shown below, the folder contains a <code class="docutils literal"><span class="pre">data</span></code> folder and a <code class="docutils literal"><span class="pre">run.py</span></code> folder as shown below.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/wamit_tut_dir.png"><img alt="_images/wamit_tut_dir.png" src="_images/wamit_tut_dir.png" style="width: 400pt;" /></a>
</div>
<p>The data folder contains several example WAMIT output files. In this tutorial we will use the <code class="docutils literal"><span class="pre">wec3.out</span></code> example data. This file contains WAMIT simulation from a floating three-body oscillating flap device shown below. This device geometry was used in the Wave Energy Converter Code Comparison (WEC3) project [1] and described by Babarit et al. [2] (FIX CITATIONs).</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/wec3_device.png"><img alt="_images/wec3_device.png" src="_images/wec3_device.png" style="width: 400pt;" /></a>
</div>
<p>The <code class="docutils literal"><span class="pre">run.py</span></code> file contains a custom written script that uses the <cite>bemio</cite> <a class="reference internal" href="api.html#api"><span>API</span></a> to read the <code class="docutils literal"><span class="pre">wec3.out</span></code> file, plot hydrodynamic coefficients, and save the data in the SHDF.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#! /usr/bin/python</span>


<span class="c">#### Import matplotlib and make the session interactive for easy plot visualization ####</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>


<span class="c">#### Load the wamit module from bemio.io ####</span>
<span class="c"># This module provides functionality to read, dimensionalize, visualizes the data.</span>
<span class="kn">from</span> <span class="nn">bemio.io</span> <span class="kn">import</span> <span class="n">wamit</span>


<span class="c">#### Load the bem data object from bemio.data_structures ####</span>
<span class="c"># This module provides the functionality to save the data in the SHDF</span>
<span class="kn">from</span> <span class="nn">bemio.data_structures</span> <span class="kn">import</span> <span class="n">bem</span>


<span class="c">#### Load the data using the wamit module. ####</span>
<span class="c"># After running this line,  a object wamit_data_obj of &lt;type &#39;WamitOutput&#39;&gt; is created containing</span>
<span class="c"># the data read from the wec3.out file. The data for each of the three bodies of the floating </span>
<span class="c"># three-body oscillating flap is loaded into wamit_data_obj.data[0], wamit_data_obj.data[1],</span>
<span class="c"># and wamit_data_obj.data[2]</span>
<span class="n">wamit_data_obj</span> <span class="o">=</span> <span class="n">wamit</span><span class="o">.</span><span class="n">WamitOutput</span><span class="p">(</span><span class="n">out_file</span><span class="o">=</span><span class="s">&#39;./data/wec3.out&#39;</span><span class="p">)</span>


<span class="c">#### Plot the added hydrodynamic coefficients for visualization using the wamit module ####</span>
<span class="c"># Specifically, the surge (0,0 component) and heave (2,2 component) for body0 in the WAMTI</span>
<span class="c"># simulation are plotted using matplotlib. Note that Python uses zero indexing.</span>
<span class="n">components_to_plot</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">wamit_data_obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot_am_rd</span><span class="p">(</span><span class="n">components_to_plot</span><span class="p">)</span>


<span class="c">#### Calculate IRF and plot using the wamit module ####</span>
<span class="c"># The loop below loops through each of the bodies and calculates the impulse response function</span>
<span class="c"># and state space coefficients. In this case, the impulse response function is calculated from</span>
<span class="c"># 0 to 50 seconds by setting t_end=50, using 101 timesteps n_t=101, and using 201 frequency steps</span>
<span class="c"># n_w = 201</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">wamit_data_obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">num_bodies</span><span class="p">):</span>
	<span class="n">wamit_data_obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">calc_irf</span><span class="p">(</span><span class="n">t_end</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n_t</span> <span class="o">=</span> <span class="mi">101</span><span class="p">,</span> <span class="n">n_w</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
	<span class="n">wamit_data_obj</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">calc_ss</span><span class="p">()</span>

<span class="c">#### Save the data in SHDF format using the bem module ####</span>
<span class="c"># The data is written to the file name specified by the out_file string. The wamit_data_obj</span>
<span class="c"># contains a dictionary named &#39;files&#39; with an entry &#39;hdf5&#39; which contains the default file name</span>
<span class="c"># wec3.h5</span>
<span class="n">bem</span><span class="o">.</span><span class="n">write_hdf5</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wamit_data_obj</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="n">wamit_data_obj</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s">&#39;hdf5&#39;</span><span class="p">])</span>


<span class="c">#### Keep Python running so the user can view the plots ####</span>
<span class="nb">raw_input</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">Press enter to exit and close plots&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Running the script above produces the following output:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/wamit_tut_run.png"><img alt="_images/wamit_tut_run.png" src="_images/wamit_tut_run.png" style="width: 500pt;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/wamit_tut_fig.png"><img alt="_images/wamit_tut_fig.png" src="_images/wamit_tut_fig.png" style="width: 400pt;" /></a>
</div>
<div class="section" id="viewing-the-shdf-file">
<h3>Viewing the SHDF File<a class="headerlink" href="#viewing-the-shdf-file" title="Permalink to this headline">¶</a></h3>
<p>The SHDF file containing the WAMIT data was written to <code class="docutils literal"><span class="pre">$BEMIO_TUTORIALS/wamit/data/wec3.h5</span></code> and can be viewed using <a class="reference external" href="http://www.hdfgroup.org/products/java/hdfview/">HDFVIEW</a> as shown below. <a class="reference external" href="http://www.hdfgroup.org/products/java/hdfview/">HDFVIEW</a> allows the different data to be viewed and simple line plots to be made. For example, the image below shows the added mass matrix (<code class="docutils literal"><span class="pre">wamit_data_obj.data[0].am.all</span></code>) with a shape of 6 x 6*num_bodies x num_frequencies, the body name from the WAMTI file (<code class="docutils literal"><span class="pre">wamit_data_obj.data[0].name</span></code>), the body center of gravity from the WAMIT file (<code class="docutils literal"><span class="pre">wamit_data_obj.data[0].cg</span></code>). Also shown is the 1,1 (surge) component of the added mass matrix, which is stored in the SHDF file in the <code class="docutils literal"><span class="pre">bodyN/added_mass/comps/comp_1_1</span></code> file. <a class="reference external" href="http://www.hdfgroup.org/products/java/hdfview/">HDFVIEW</a> was used to plot this added mass component.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/wamit_tut_shdf.png"><img alt="_images/wamit_tut_shdf.png" src="_images/wamit_tut_shdf.png" style="width: 550pt;" /></a>
</div>
</div>
</div>
<div class="section" id="nemoh">
<span id="nemoh-tut"></span><h2>NEMOH<a class="headerlink" href="#nemoh" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="aqwa">
<span id="aqwa-tut"></span><h2>AQWA<a class="headerlink" href="#aqwa" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="module_doc.html" class="btn btn-neutral float-right" title="bemio Module Documentation">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api.html" class="btn btn-neutral" title="API"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, National Renewable Energy Laboratory and Sandia National Laboratories.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'v1.0a0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>